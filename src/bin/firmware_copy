#!/bin/sh 

source $HATHOR/config/basic_config
source $HATHOR/lib/libfirmwareinfo

hathor_get_firmware_path

DIRECTORY_TO_PUT_FIRMWARE=$FIRMWARE_VERSION

FIRMWARE_TO_UPLOAD="`ls $RELEASE_DIR/$PRODUCTVER.* $RELEASE_DIR/*.lst`"
for f in $FIRMWARE_TO_UPLOAD; do
	PUT_COMMAND="put $f `basename $f`; $PUT_COMMAND"
done
SMB_CMD_FIRMWARE="mkdir $DIRECTORY_TO_PUT_FIRMWARE; cd $DIRECTORY_TO_PUT_FIRMWARE; $PUT_COMMAND; cd .."
SMB_CMD_HISTORY="get history.txt history.txt.bak; put $RELEASE_DIR/history.txt history.txt; put history.txt.bak"
SMB_COMMAND="$SMB_CMD_FIRMWARE; $SMB_CMD_HISTORY"

# create directory
#echo "smbclient \"$FIRMWARE_PATH_SERVER_REVERTED\" -U $USERNAME_ATHENA -D \"$HATHOR_FIRMWARE_PATH_PREFIX_REVERTED/\" -c \"$SMB_COMMAND\""
smbclient "$FIRMWARE_PATH_SERVER_REVERTED" -U $USERNAME_ATHENA -D "$HATHOR_FIRMWARE_PATH_PREFIX_REVERTED/" -c "$SMB_COMMAND"

